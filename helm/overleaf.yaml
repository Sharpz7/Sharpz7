#
# IMPORTANT NOTE
#
# This chart inherits from our common library chart. You can check the default values/options here:
# https://github.com/k8s-at-home/library-charts/tree/main/charts/stable/common/values.yaml
#

image:
  # -- image repository
  repository: sharelatex/sharelatex
  # -- image tag
  tag: 2.7.1
  # -- image pull policy
  pullPolicy: IfNotPresent

ingress:
  # -- Enable and configure ingress settings for the chart under this key.
  # @default -- See values.yaml
  main:
    enabled: true

    annotations:
      kubernetes.io/ingress.class: traefik
      traefik.ingress.kubernetes.io/router.middlewares: default-redirect-https@kubernetescrd

    hosts:
      - host: "overleaf.${DOMAIN}"

    # -- Configure TLS for the ingress. Both secretName and hosts can process a Helm template.
    tls:
     - secretName: ${DOMAIN}-tls
       hosts:
         - "overleaf.${DOMAIN}"

persistence:
  data:
    enabled: true
    type: pvc
    mountPath: /var/lib/sharelatex
    accessMode: ReadWriteOnce
    retain: true
    size: 1Gi

env:
  SHARELATEX_REDIS_HOST: overleaf-redis-master
  REDIS_HOST: overleaf-redis-master
  SHARELATEX_MONGO_URL: mongodb://overleaf-mongodb:27017/sharelatex

redis:
  enabled: true
  fullnameOverride: overleaf-redis
  replica:
    replicaCount: 1

mongodb:
  enabled: true
  fullnameOverride: overleaf-mongodb